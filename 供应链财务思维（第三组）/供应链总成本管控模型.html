<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è½´æ‰¿ä¾›åº”é“¾æ€»æˆæœ¬ç®¡æ§æ¨¡å‹ - ç“¦è½´é›†å›¢</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; color: #fff; }
        .header { background: linear-gradient(90deg, #0f3460, #533483); padding: 20px; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.3); }
        .header h1 { font-size: 2em; margin-bottom: 10px; }
        .header p { color: #a0a0a0; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .tab { padding: 12px 24px; background: rgba(255,255,255,0.1); border: none; color: #fff; cursor: pointer; border-radius: 8px; transition: all 0.3s; }
        .tab:hover { background: rgba(255,255,255,0.2); }
        .tab.active { background: linear-gradient(135deg, #e94560, #533483); }
        .panel { display: none; background: rgba(255,255,255,0.05); border-radius: 12px; padding: 25px; }
        .panel.active { display: block; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .card { background: rgba(255,255,255,0.08); border-radius: 10px; padding: 20px; border: 1px solid rgba(255,255,255,0.1); }
        .card h3 { color: #e94560; margin-bottom: 15px; font-size: 1.1em; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; color: #a0a0a0; font-size: 0.9em; }
        .form-group input { width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; background: rgba(255,255,255,0.1); color: #fff; }
        .form-group input:focus { outline: none; border-color: #e94560; }
        .btn { padding: 12px 30px; background: linear-gradient(135deg, #e94560, #533483); border: none; color: #fff; border-radius: 8px; cursor: pointer; font-size: 1em; transition: transform 0.2s; }
        .btn:hover { transform: scale(1.02); }
        .result-card { background: linear-gradient(135deg, rgba(83,52,131,0.3), rgba(233,69,96,0.3)); border-radius: 12px; padding: 25px; margin-top: 20px; }
        .result-item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .result-item:last-child { border-bottom: none; }
        .result-item .label { color: #a0a0a0; }
        .result-item .value { font-weight: bold; color: #4ade80; font-size: 1.1em; }
        .total-cost { font-size: 2em; color: #e94560; text-align: center; padding: 20px; background: rgba(233,69,96,0.2); border-radius: 10px; margin-top: 20px; }
        .chart-container { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 20px; margin-top: 20px; }
        .formula-box { background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace; margin: 10px 0; border-left: 4px solid #e94560; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { background: rgba(233,69,96,0.2); color: #e94560; }
        .back-btn { position: fixed; bottom: 20px; right: 20px; padding: 15px 25px; background: linear-gradient(135deg, #533483, #0f3460); border-radius: 50px; text-decoration: none; color: #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”§ è½´æ‰¿ä¾›åº”é“¾æ€»æˆæœ¬ç®¡æ§æ¨¡å‹</h1>
        <p>ç“¦è½´é›†å›¢ | åŸºäºä½œä¸šæˆæœ¬æ³•çš„å…¨ä¾›åº”é“¾æˆæœ¬åˆ†æå·¥å…·</p>
    </div>
    
    <div class="container">
        <div class="tabs">
            <button class="tab active" onclick="showPanel('overview')">ğŸ“Š æ¨¡å‹æ¦‚è¿°</button>
            <button class="tab" onclick="showPanel('direct')">ğŸ’° ç›´æ¥æˆæœ¬</button>
            <button class="tab" onclick="showPanel('activity')">âš™ï¸ ä½œä¸šæˆæœ¬</button>
            <button class="tab" onclick="showPanel('capital')">ğŸ’µ èµ„é‡‘æˆæœ¬</button>
            <button class="tab" onclick="showPanel('risk')">âš ï¸ é£é™©æˆæœ¬</button>
            <button class="tab" onclick="showPanel('summary')">ğŸ“ˆ æˆæœ¬æ±‡æ€»</button>
        </div>

        <!-- æ¨¡å‹æ¦‚è¿°é¢æ¿ -->
        <div id="overview" class="panel active">
            <h2 style="margin-bottom: 20px;">æ€»æˆæœ¬æ„æˆä½“ç³»</h2>
            <div class="formula-box">
                <strong>æ€»æˆæœ¬è®¡ç®—å…¬å¼ï¼š</strong><br>
                æ€»æˆæœ¬ = ç›´æ¥ææ–™æˆæœ¬ + ç›´æ¥äººå·¥æˆæœ¬ + ç›´æ¥åˆ¶é€ è´¹ç”¨ + ä½œä¸šæˆæœ¬ + èµ„é‡‘æˆæœ¬ + é£é™©æˆæœ¬
            </div>
            <div class="grid" style="margin-top: 20px;">
                <div class="card">
                    <h3>ğŸ’° ç›´æ¥æˆæœ¬</h3>
                    <p>åŸææ–™æˆæœ¬ï¼šé’¢æã€æ»šç ã€ä¿æŒæ¶ã€å¯†å°åœˆ</p>
                    <p>ç›´æ¥äººå·¥ï¼šç”Ÿäº§å·¥äººå·¥èµ„ã€å¥–é‡‘ã€æ´¥è´´</p>
                    <p>ç›´æ¥åˆ¶é€ è´¹ç”¨ï¼šè®¾å¤‡æŠ˜æ—§ã€èƒ½æºæ¶ˆè€—</p>
                </div>
                <div class="card">
                    <h3>âš™ï¸ ä½œä¸šæˆæœ¬ï¼ˆABCæ³•ï¼‰</h3>
                    <p>é‡‡è´­ä½œä¸šï¼šä¾›åº”å•†å¼€å‘ã€è¯¢ä»·æ¯”ä»·ã€åˆåŒç®¡ç†</p>
                    <p>è´¨æ£€ä½œä¸šï¼šè¿›æ–™æ£€éªŒã€è¿‡ç¨‹æ£€éªŒã€æˆå“æ£€éªŒ</p>
                    <p>ä»“å‚¨ä½œä¸šï¼šå…¥åº“ã€å­˜å‚¨ä¿ç®¡ã€å‡ºåº“ä½œä¸š</p>
                    <p>è¿è¾“ä½œä¸šï¼šå†…éƒ¨è¿è¾“ã€å¤–éƒ¨é…é€</p>
                </div>
                <div class="card">
                    <h3>ğŸ’µ èµ„é‡‘æˆæœ¬</h3>
                    <p>åº“å­˜èµ„é‡‘å ç”¨ï¼šåŸææ–™ã€åœ¨åˆ¶å“ã€äº§æˆå“</p>
                    <p>åº”æ”¶è´¦æ¬¾æˆæœ¬ï¼šå®¢æˆ·è´¦æœŸäº§ç”Ÿçš„èµ„é‡‘æˆæœ¬</p>
                </div>
                <div class="card">
                    <h3>âš ï¸ é£é™©æˆæœ¬</h3>
                    <p>è´¨é‡æŸå¤±ï¼šé€€è´§ã€ç´¢èµ”ã€å“ç‰Œå½±å“</p>
                    <p>ä¾›åº”ä¸­æ–­ï¼šç¼ºè´§æŸå¤±ã€ç´§æ€¥é‡‡è´­æº¢ä»·</p>
                    <p>ä»·æ ¼æ³¢åŠ¨ï¼šåŸææ–™ä»·æ ¼æ³¢åŠ¨é£é™©</p>
                </div>
            </div>
        </div>

        <!-- ç›´æ¥æˆæœ¬é¢æ¿ -->
        <div id="direct" class="panel">
            <h2 style="margin-bottom: 20px;">ç›´æ¥æˆæœ¬æ ¸ç®—</h2>
            <div class="grid">
                <div class="card">
                    <h3>ğŸ“¦ åŸææ–™æˆæœ¬</h3>
                    <div class="form-group">
                        <label>é’¢ææˆæœ¬ï¼ˆå…ƒ/ä»¶ï¼‰</label>
                        <input type="number" id="steel_cost" value="45.00" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>æ»šç æˆæœ¬ï¼ˆå…ƒ/ä»¶ï¼‰</label>
                        <input type="number" id="ball_cost" value="12.50" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>ä¿æŒæ¶æˆæœ¬ï¼ˆå…ƒ/ä»¶ï¼‰</label>
                        <input type="number" id="cage_cost" value="8.00" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>å¯†å°åœˆæˆæœ¬ï¼ˆå…ƒ/ä»¶ï¼‰</label>
                        <input type="number" id="seal_cost" value="3.50" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>ç”Ÿäº§æ•°é‡ï¼ˆä»¶ï¼‰</label>
                        <input type="number" id="production_qty" value="10000" onchange="updateDirectCost()">
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸ‘· ç›´æ¥äººå·¥æˆæœ¬</h3>
                    <div class="form-group">
                        <label>å·¥äººæ•°é‡ï¼ˆäººï¼‰</label>
                        <input type="number" id="worker_count" value="50" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>äººå‡æœˆå·¥èµ„ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="avg_salary" value="6500" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>æœˆç”Ÿäº§å¤©æ•°ï¼ˆå¤©ï¼‰</label>
                        <input type="number" id="work_days" value="22" onchange="updateDirectCost()">
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸ­ ç›´æ¥åˆ¶é€ è´¹ç”¨</h3>
                    <div class="form-group">
                        <label>è®¾å¤‡æŠ˜æ—§ï¼ˆå…ƒ/æœˆï¼‰</label>
                        <input type="number" id="depreciation" value="85000" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>èƒ½æºè´¹ç”¨ï¼ˆå…ƒ/æœˆï¼‰</label>
                        <input type="number" id="energy_cost" value="45000" onchange="updateDirectCost()">
                    </div>
                    <div class="form-group">
                        <label>å…¶ä»–åˆ¶é€ è´¹ç”¨ï¼ˆå…ƒ/æœˆï¼‰</label>
                        <input type="number" id="other_mfg" value="25000" onchange="updateDirectCost()">
                    </div>
                </div>
            </div>
            <div class="result-card">
                <h3 style="margin-bottom: 15px;">ğŸ“Š ç›´æ¥æˆæœ¬æ±‡æ€»</h3>
                <div class="result-item"><span class="label">åŸææ–™æ€»æˆæœ¬</span><span class="value" id="material_total">Â¥690,000.00</span></div>
                <div class="result-item"><span class="label">ç›´æ¥äººå·¥æˆæœ¬</span><span class="value" id="labor_total">Â¥325,000.00</span></div>
                <div class="result-item"><span class="label">ç›´æ¥åˆ¶é€ è´¹ç”¨</span><span class="value" id="overhead_total">Â¥155,000.00</span></div>
                <div class="result-item"><span class="label"><strong>ç›´æ¥æˆæœ¬åˆè®¡</strong></span><span class="value" id="direct_total" style="color:#e94560;font-size:1.3em;">Â¥1,170,000.00</span></div>
            </div>
        </div>

        <!-- ä½œä¸šæˆæœ¬é¢æ¿ -->
        <div id="activity" class="panel">
            <h2 style="margin-bottom: 20px;">ä½œä¸šæˆæœ¬æ ¸ç®—ï¼ˆABCæ³•ï¼‰</h2>
            <div class="formula-box">
                <strong>ä½œä¸šæˆæœ¬è®¡ç®—ï¼š</strong><br>
                ä½œä¸šæˆæœ¬ = âˆ‘(ä½œä¸šæˆæœ¬æ± é‡‘é¢ Ã— ä½œä¸šåŠ¨å› æ¶ˆè€—é‡ Ã· ä½œä¸šåŠ¨å› æ€»é‡)
            </div>
            <div class="grid" style="margin-top: 20px;">
                <div class="card">
                    <h3>ğŸ“‹ é‡‡è´­ä½œä¸šæˆæœ¬</h3>
                    <div class="form-group">
                        <label>é‡‡è´­éƒ¨é—¨æœˆè´¹ç”¨ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="proc_dept_cost" value="180000" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœˆé‡‡è´­è®¢å•æ€»æ•°ï¼ˆç¬”ï¼‰</label>
                        <input type="number" id="total_orders" value="200" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœ¬äº§å“è®¢å•æ•°ï¼ˆç¬”ï¼‰</label>
                        <input type="number" id="product_orders" value="25" onchange="updateActivityCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <small>åˆ†é…ç‡ï¼š<span id="proc_rate">Â¥900.00</span>/ç¬”</small><br>
                        <strong>é‡‡è´­æˆæœ¬ï¼š<span id="proc_cost" style="color:#4ade80;">Â¥22,500.00</span></strong>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸ” è´¨æ£€ä½œä¸šæˆæœ¬</h3>
                    <div class="form-group">
                        <label>è´¨æ£€éƒ¨é—¨æœˆè´¹ç”¨ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="qc_dept_cost" value="120000" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœˆæ£€éªŒæ‰¹æ¬¡æ€»æ•°ï¼ˆæ‰¹ï¼‰</label>
                        <input type="number" id="total_batches" value="150" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœ¬äº§å“æ£€éªŒæ‰¹æ¬¡ï¼ˆæ‰¹ï¼‰</label>
                        <input type="number" id="product_batches" value="20" onchange="updateActivityCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <small>åˆ†é…ç‡ï¼š<span id="qc_rate">Â¥800.00</span>/æ‰¹</small><br>
                        <strong>è´¨æ£€æˆæœ¬ï¼š<span id="qc_cost" style="color:#4ade80;">Â¥16,000.00</span></strong>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸª ä»“å‚¨ä½œä¸šæˆæœ¬</h3>
                    <div class="form-group">
                        <label>ä»“å‚¨éƒ¨é—¨æœˆè´¹ç”¨ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="wh_dept_cost" value="95000" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœˆå‡ºå…¥åº“æ€»æ¬¡æ•°ï¼ˆæ¬¡ï¼‰</label>
                        <input type="number" id="total_movements" value="500" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœ¬äº§å“å‡ºå…¥åº“æ¬¡æ•°ï¼ˆæ¬¡ï¼‰</label>
                        <input type="number" id="product_movements" value="60" onchange="updateActivityCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <small>åˆ†é…ç‡ï¼š<span id="wh_rate">Â¥190.00</span>/æ¬¡</small><br>
                        <strong>ä»“å‚¨æˆæœ¬ï¼š<span id="wh_cost" style="color:#4ade80;">Â¥11,400.00</span></strong>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸšš è¿è¾“ä½œä¸šæˆæœ¬</h3>
                    <div class="form-group">
                        <label>è¿è¾“éƒ¨é—¨æœˆè´¹ç”¨ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="trans_dept_cost" value="75000" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœˆè¿è¾“æ€»é‡é‡ï¼ˆå¨ï¼‰</label>
                        <input type="number" id="total_weight" value="300" onchange="updateActivityCost()">
                    </div>
                    <div class="form-group">
                        <label>æœ¬äº§å“è¿è¾“é‡é‡ï¼ˆå¨ï¼‰</label>
                        <input type="number" id="product_weight" value="35" onchange="updateActivityCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <small>åˆ†é…ç‡ï¼š<span id="trans_rate">Â¥250.00</span>/å¨</small><br>
                        <strong>è¿è¾“æˆæœ¬ï¼š<span id="trans_cost" style="color:#4ade80;">Â¥8,750.00</span></strong>
                    </div>
                </div>
            </div>
            <div class="result-card">
                <h3 style="margin-bottom: 15px;">ğŸ“Š ä½œä¸šæˆæœ¬æ±‡æ€»</h3>
                <div class="result-item"><span class="label">é‡‡è´­ä½œä¸šæˆæœ¬</span><span class="value" id="proc_summary">Â¥22,500.00</span></div>
                <div class="result-item"><span class="label">è´¨æ£€ä½œä¸šæˆæœ¬</span><span class="value" id="qc_summary">Â¥16,000.00</span></div>
                <div class="result-item"><span class="label">ä»“å‚¨ä½œä¸šæˆæœ¬</span><span class="value" id="wh_summary">Â¥11,400.00</span></div>
                <div class="result-item"><span class="label">è¿è¾“ä½œä¸šæˆæœ¬</span><span class="value" id="trans_summary">Â¥8,750.00</span></div>
                <div class="result-item"><span class="label"><strong>ä½œä¸šæˆæœ¬åˆè®¡</strong></span><span class="value" id="activity_total" style="color:#e94560;font-size:1.3em;">Â¥58,650.00</span></div>
            </div>
        </div>

        <!-- èµ„é‡‘æˆæœ¬é¢æ¿ -->
        <div id="capital" class="panel">
            <h2 style="margin-bottom: 20px;">èµ„é‡‘å ç”¨æˆæœ¬</h2>
            <div class="formula-box">
                <strong>èµ„é‡‘å ç”¨æˆæœ¬è®¡ç®—ï¼š</strong><br>
                èµ„é‡‘å ç”¨æˆæœ¬ = å¹³å‡åº“å­˜é‡‘é¢ Ã— èµ„é‡‘æˆæœ¬ç‡ Ã— åº“å­˜å‘¨è½¬å¤©æ•° Ã· 365
            </div>
            <div class="grid" style="margin-top: 20px;">
                <div class="card">
                    <h3>ğŸ“¦ åº“å­˜èµ„é‡‘å ç”¨æˆæœ¬</h3>
                    <div class="form-group">
                        <label>åŸææ–™å¹³å‡åº“å­˜ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="raw_inventory" value="850000" onchange="updateCapitalCost()">
                    </div>
                    <div class="form-group">
                        <label>åœ¨åˆ¶å“å¹³å‡åº“å­˜ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="wip_inventory" value="320000" onchange="updateCapitalCost()">
                    </div>
                    <div class="form-group">
                        <label>äº§æˆå“å¹³å‡åº“å­˜ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="fg_inventory" value="580000" onchange="updateCapitalCost()">
                    </div>
                    <div class="form-group">
                        <label>èµ„é‡‘æˆæœ¬ç‡ï¼ˆ%/å¹´ï¼‰</label>
                        <input type="number" id="capital_rate" value="6.5" step="0.1" onchange="updateCapitalCost()">
                    </div>
                    <div class="form-group">
                        <label>å¹³å‡åº“å­˜å‘¨è½¬å¤©æ•°</label>
                        <input type="number" id="turnover_days" value="45" onchange="updateCapitalCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <small>åº“å­˜æ€»é¢ï¼š<span id="total_inventory">Â¥1,750,000.00</span></small><br>
                        <strong>åº“å­˜èµ„é‡‘æˆæœ¬ï¼š<span id="inv_capital_cost" style="color:#4ade80;">Â¥14,024.66</span></strong>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸ’³ åº”æ”¶è´¦æ¬¾èµ„é‡‘æˆæœ¬</h3>
                    <div class="form-group">
                        <label>åº”æ”¶è´¦æ¬¾ä½™é¢ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="receivable_balance" value="2500000" onchange="updateCapitalCost()">
                    </div>
                    <div class="form-group">
                        <label>å¹³å‡è´¦æœŸï¼ˆå¤©ï¼‰</label>
                        <input type="number" id="avg_credit_days" value="60" onchange="updateCapitalCost()">
                    </div>
                    <div class="form-group">
                        <label>èµ„é‡‘æˆæœ¬ç‡ï¼ˆ%/å¹´ï¼‰</label>
                        <input type="number" id="ar_capital_rate" value="6.5" step="0.1" onchange="updateCapitalCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <strong>åº”æ”¶æ¬¾èµ„é‡‘æˆæœ¬ï¼š<span id="ar_capital_cost" style="color:#4ade80;">Â¥26,712.33</span></strong>
                    </div>
                </div>
            </div>
            <div class="result-card">
                <h3 style="margin-bottom: 15px;">ğŸ“Š èµ„é‡‘æˆæœ¬æ±‡æ€»</h3>
                <div class="result-item"><span class="label">åº“å­˜èµ„é‡‘å ç”¨æˆæœ¬</span><span class="value" id="inv_summary">Â¥14,024.66</span></div>
                <div class="result-item"><span class="label">åº”æ”¶è´¦æ¬¾èµ„é‡‘æˆæœ¬</span><span class="value" id="ar_summary">Â¥26,712.33</span></div>
                <div class="result-item"><span class="label"><strong>èµ„é‡‘æˆæœ¬åˆè®¡</strong></span><span class="value" id="capital_total" style="color:#e94560;font-size:1.3em;">Â¥40,736.99</span></div>
            </div>
        </div>

        <!-- é£é™©æˆæœ¬é¢æ¿ -->
        <div id="risk" class="panel">
            <h2 style="margin-bottom: 20px;">é£é™©æˆæœ¬è¯„ä¼°</h2>
            <div class="grid">
                <div class="card">
                    <h3>ğŸ”´ è´¨é‡æŸå¤±æˆæœ¬</h3>
                    <div class="form-group">
                        <label>æœˆé€€è´§æ•°é‡ï¼ˆä»¶ï¼‰</label>
                        <input type="number" id="return_qty" value="150" onchange="updateRiskCost()">
                    </div>
                    <div class="form-group">
                        <label>å•ä»¶é€€è´§å¤„ç†æˆæœ¬ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="return_unit_cost" value="85" onchange="updateRiskCost()">
                    </div>
                    <div class="form-group">
                        <label>æœˆç´¢èµ”é‡‘é¢ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="claim_amount" value="25000" onchange="updateRiskCost()">
                    </div>
                    <div class="form-group">
                        <label>å“ç‰Œå½±å“ä¼°å€¼ï¼ˆå…ƒ/æœˆï¼‰</label>
                        <input type="number" id="brand_impact" value="15000" onchange="updateRiskCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <strong>è´¨é‡æŸå¤±æˆæœ¬ï¼š<span id="quality_risk_cost" style="color:#f97316;">Â¥52,750.00</span></strong>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸŸ  ä¾›åº”ä¸­æ–­æˆæœ¬</h3>
                    <div class="form-group">
                        <label>æœˆç¼ºè´§æ¬¡æ•°ï¼ˆæ¬¡ï¼‰</label>
                        <input type="number" id="stockout_times" value="3" onchange="updateRiskCost()">
                    </div>
                    <div class="form-group">
                        <label>å•æ¬¡ç¼ºè´§æŸå¤±ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="stockout_loss" value="8500" onchange="updateRiskCost()">
                    </div>
                    <div class="form-group">
                        <label>ç´§æ€¥é‡‡è´­æº¢ä»·ï¼ˆå…ƒ/æœˆï¼‰</label>
                        <input type="number" id="urgent_premium" value="12000" onchange="updateRiskCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <strong>ä¾›åº”ä¸­æ–­æˆæœ¬ï¼š<span id="supply_risk_cost" style="color:#f97316;">Â¥37,500.00</span></strong>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸŸ¡ ä»·æ ¼æ³¢åŠ¨æˆæœ¬</h3>
                    <div class="form-group">
                        <label>æœˆé‡‡è´­é‡‘é¢ï¼ˆå…ƒï¼‰</label>
                        <input type="number" id="monthly_purchase" value="690000" onchange="updateRiskCost()">
                    </div>
                    <div class="form-group">
                        <label>ä»·æ ¼æ³¢åŠ¨ç‡ï¼ˆ%ï¼‰</label>
                        <input type="number" id="price_volatility" value="3.5" step="0.1" onchange="updateRiskCost()">
                    </div>
                    <div class="form-group">
                        <label>é£é™©æ•å£æ¯”ä¾‹ï¼ˆ%ï¼‰</label>
                        <input type="number" id="risk_exposure" value="40" onchange="updateRiskCost()">
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:6px;margin-top:10px;">
                        <strong>ä»·æ ¼æ³¢åŠ¨æˆæœ¬ï¼š<span id="price_risk_cost" style="color:#f97316;">Â¥9,660.00</span></strong>
                    </div>
                </div>
            </div>
            <div class="result-card">
                <h3 style="margin-bottom: 15px;">ğŸ“Š é£é™©æˆæœ¬æ±‡æ€»</h3>
                <div class="result-item"><span class="label">è´¨é‡æŸå¤±æˆæœ¬</span><span class="value" id="quality_summary">Â¥52,750.00</span></div>
                <div class="result-item"><span class="label">ä¾›åº”ä¸­æ–­æˆæœ¬</span><span class="value" id="supply_summary">Â¥37,500.00</span></div>
                <div class="result-item"><span class="label">ä»·æ ¼æ³¢åŠ¨æˆæœ¬</span><span class="value" id="price_summary">Â¥9,660.00</span></div>
                <div class="result-item"><span class="label"><strong>é£é™©æˆæœ¬åˆè®¡</strong></span><span class="value" id="risk_total" style="color:#e94560;font-size:1.3em;">Â¥99,910.00</span></div>
            </div>
        </div>

        <!-- æˆæœ¬æ±‡æ€»é¢æ¿ -->
        <div id="summary" class="panel">
            <h2 style="margin-bottom: 20px;">æ€»æˆæœ¬åˆ†ææ±‡æ€»</h2>
            <div class="total-cost">
                <div style="font-size:0.5em;color:#a0a0a0;margin-bottom:10px;">ä¾›åº”é“¾æ€»æˆæœ¬</div>
                <span id="grand_total">Â¥1,369,296.99</span>
                <div style="font-size:0.4em;color:#a0a0a0;margin-top:10px;">å•ä»¶æˆæœ¬ï¼š<span id="unit_cost">Â¥136.93</span></div>
            </div>
            <div class="grid" style="margin-top:20px;">
                <div class="chart-container">
                    <h3 style="margin-bottom:15px;">ğŸ“Š æˆæœ¬ç»“æ„åˆ†æ</h3>
                    <canvas id="costPieChart" width="400" height="300"></canvas>
                </div>
                <div class="card">
                    <h3>ğŸ“‹ æˆæœ¬æ˜ç»†è¡¨</h3>
                    <table>
                        <thead>
                            <tr><th>æˆæœ¬ç±»åˆ«</th><th>é‡‘é¢ï¼ˆå…ƒï¼‰</th><th>å æ¯”</th></tr>
                        </thead>
                        <tbody id="costTableBody">
                            <tr><td>ç›´æ¥ææ–™æˆæœ¬</td><td id="tb_material">690,000.00</td><td id="tb_material_pct">50.4%</td></tr>
                            <tr><td>ç›´æ¥äººå·¥æˆæœ¬</td><td id="tb_labor">325,000.00</td><td id="tb_labor_pct">23.7%</td></tr>
                            <tr><td>ç›´æ¥åˆ¶é€ è´¹ç”¨</td><td id="tb_overhead">155,000.00</td><td id="tb_overhead_pct">11.3%</td></tr>
                            <tr><td>ä½œä¸šæˆæœ¬</td><td id="tb_activity">58,650.00</td><td id="tb_activity_pct">4.3%</td></tr>
                            <tr><td>èµ„é‡‘æˆæœ¬</td><td id="tb_capital">40,736.99</td><td id="tb_capital_pct">3.0%</td></tr>
                            <tr><td>é£é™©æˆæœ¬</td><td id="tb_risk">99,910.00</td><td id="tb_risk_pct">7.3%</td></tr>
                            <tr style="background:rgba(233,69,96,0.2);font-weight:bold;">
                                <td>åˆè®¡</td><td id="tb_total">1,369,296.99</td><td>100%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="grid" style="margin-top:20px;">
                <div class="card">
                    <h3>ğŸ’¡ æˆæœ¬ä¼˜åŒ–å»ºè®®</h3>
                    <div id="suggestions" style="line-height:1.8;">
                        <p>ğŸ“Œ <strong>ç›´æ¥ææ–™</strong>å æ¯”è¶…è¿‡50%ï¼Œå»ºè®®åŠ å¼ºä¾›åº”å•†è°ˆåˆ¤å’Œæ‰¹é‡é‡‡è´­</p>
                        <p>ğŸ“Œ <strong>é£é™©æˆæœ¬</strong>å æ¯”7.3%ï¼Œå»ºè®®å¼ºåŒ–è´¨é‡ç®¡æ§å’Œä¾›åº”å•†å¤šå…ƒåŒ–</p>
                        <p>ğŸ“Œ <strong>èµ„é‡‘æˆæœ¬</strong>å¯é€šè¿‡ç¼©çŸ­åº“å­˜å‘¨è½¬å¤©æ•°é™ä½</p>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸ“ˆ å…³é”®æŒ‡æ ‡</h3>
                    <div class="result-item"><span class="label">å•ä½äº§å“æ€»æˆæœ¬</span><span class="value" id="kpi_unit_cost">Â¥136.93</span></div>
                    <div class="result-item"><span class="label">éšæ€§æˆæœ¬å æ¯”</span><span class="value" id="kpi_hidden_pct">14.6%</span></div>
                    <div class="result-item"><span class="label">ä½œä¸šæˆæœ¬åŠ¨å› æ•ˆç‡</span><span class="value" id="kpi_abc_efficiency">è‰¯å¥½</span></div>
                    <div class="result-item"><span class="label">èµ„é‡‘å‘¨è½¬æ•ˆç‡</span><span class="value" id="kpi_turnover">45å¤©</span></div>
                </div>
            </div>
            <div style="text-align:center;margin-top:20px;">
                <button class="btn" onclick="recalculateAll()">ğŸ”„ é‡æ–°è®¡ç®—æ‰€æœ‰æˆæœ¬</button>
                <button class="btn" style="margin-left:10px;background:linear-gradient(135deg,#0f3460,#16213e);" onclick="exportReport()">ğŸ“¥ å¯¼å‡ºæŠ¥è¡¨</button>
            </div>
        </div>
    </div>

    <a href="index.html" class="back-btn">â† è¿”å›å¼•å¯¼é¡µ</a>

    <script>
        // é¢æ¿åˆ‡æ¢å‡½æ•°
        function showPanel(panelId) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(panelId).classList.add('active');
            event.target.classList.add('active');
        }

        // æˆæœ¬æ•°æ®å¯¹è±¡
        const costData = {
            direct: { material: 0, labor: 0, overhead: 0 },
            activity: { procurement: 0, quality: 0, warehouse: 0, transport: 0, order: 0 },
            capital: { inventory: 0, receivable: 0 },
            risk: { quality: 0, supply: 0, price: 0 }
        };

        // æ ¼å¼åŒ–é‡‘é¢
        function formatMoney(num) {
            return num.toLocaleString('zh-CN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        // è®¡ç®—æ€»æˆæœ¬
        function calculateTotalCost() {
            const directTotal = costData.direct.material + costData.direct.labor + costData.direct.overhead;
            const activityTotal = Object.values(costData.activity).reduce((a, b) => a + b, 0);
            const capitalTotal = costData.capital.inventory + costData.capital.receivable;
            const riskTotal = Object.values(costData.risk).reduce((a, b) => a + b, 0);
            return directTotal + activityTotal + capitalTotal + riskTotal;
        }

        // æ›´æ–°ç›´æ¥æˆæœ¬
        function updateDirectCost() {
            const steel = parseFloat(document.getElementById('steel_cost').value) || 0;
            const ball = parseFloat(document.getElementById('ball_cost').value) || 0;
            const cage = parseFloat(document.getElementById('cage_cost').value) || 0;
            const seal = parseFloat(document.getElementById('seal_cost').value) || 0;
            const qty = parseFloat(document.getElementById('production_qty').value) || 0;
            
            const materialTotal = (steel + ball + cage + seal) * qty;
            costData.direct.material = materialTotal;
            document.getElementById('material_total').textContent = 'Â¥' + formatMoney(materialTotal);
            
            const workers = parseFloat(document.getElementById('worker_count').value) || 0;
            const salary = parseFloat(document.getElementById('avg_salary').value) || 0;
            const laborTotal = workers * salary;
            costData.direct.labor = laborTotal;
            document.getElementById('labor_total').textContent = 'Â¥' + formatMoney(laborTotal);
            
            const depreciation = parseFloat(document.getElementById('depreciation').value) || 0;
            const energy = parseFloat(document.getElementById('energy_cost').value) || 0;
            const other = parseFloat(document.getElementById('other_mfg').value) || 0;
            const overheadTotal = depreciation + energy + other;
            costData.direct.overhead = overheadTotal;
            document.getElementById('overhead_total').textContent = 'Â¥' + formatMoney(overheadTotal);
            
            const directTotal = materialTotal + laborTotal + overheadTotal;
            document.getElementById('direct_total').textContent = 'Â¥' + formatMoney(directTotal);
            updateSummary();
        }

        // æ›´æ–°ä½œä¸šæˆæœ¬
        function updateActivityCost() {
            // é‡‡è´­ä½œä¸š
            const procDept = parseFloat(document.getElementById('proc_dept_cost').value) || 0;
            const totalOrders = parseFloat(document.getElementById('total_orders').value) || 1;
            const productOrders = parseFloat(document.getElementById('product_orders').value) || 0;
            const procRate = procDept / totalOrders;
            const procCost = procRate * productOrders;
            costData.activity.procurement = procCost;
            document.getElementById('proc_rate').textContent = 'Â¥' + formatMoney(procRate);
            document.getElementById('proc_cost').textContent = 'Â¥' + formatMoney(procCost);
            document.getElementById('proc_summary').textContent = 'Â¥' + formatMoney(procCost);
            
            // è´¨æ£€ä½œä¸š
            const qcDept = parseFloat(document.getElementById('qc_dept_cost').value) || 0;
            const totalBatches = parseFloat(document.getElementById('total_batches').value) || 1;
            const productBatches = parseFloat(document.getElementById('product_batches').value) || 0;
            const qcRate = qcDept / totalBatches;
            const qcCost = qcRate * productBatches;
            costData.activity.quality = qcCost;
            document.getElementById('qc_rate').textContent = 'Â¥' + formatMoney(qcRate);
            document.getElementById('qc_cost').textContent = 'Â¥' + formatMoney(qcCost);
            document.getElementById('qc_summary').textContent = 'Â¥' + formatMoney(qcCost);
            
            // ä»“å‚¨ä½œä¸š
            const whDept = parseFloat(document.getElementById('wh_dept_cost').value) || 0;
            const totalMove = parseFloat(document.getElementById('total_movements').value) || 1;
            const productMove = parseFloat(document.getElementById('product_movements').value) || 0;
            const whRate = whDept / totalMove;
            const whCost = whRate * productMove;
            costData.activity.warehouse = whCost;
            document.getElementById('wh_rate').textContent = 'Â¥' + formatMoney(whRate);
            document.getElementById('wh_cost').textContent = 'Â¥' + formatMoney(whCost);
            document.getElementById('wh_summary').textContent = 'Â¥' + formatMoney(whCost);
            
            // è¿è¾“ä½œä¸š
            const transDept = parseFloat(document.getElementById('trans_dept_cost').value) || 0;
            const totalWeight = parseFloat(document.getElementById('total_weight').value) || 1;
            const productWeight = parseFloat(document.getElementById('product_weight').value) || 0;
            const transRate = transDept / totalWeight;
            const transCost = transRate * productWeight;
            costData.activity.transport = transCost;
            document.getElementById('trans_rate').textContent = 'Â¥' + formatMoney(transRate);
            document.getElementById('trans_cost').textContent = 'Â¥' + formatMoney(transCost);
            document.getElementById('trans_summary').textContent = 'Â¥' + formatMoney(transCost);
            
            const activityTotal = procCost + qcCost + whCost + transCost;
            document.getElementById('activity_total').textContent = 'Â¥' + formatMoney(activityTotal);
            updateSummary();
        }

        // æ›´æ–°èµ„é‡‘æˆæœ¬
        function updateCapitalCost() {
            const rawInv = parseFloat(document.getElementById('raw_inventory').value) || 0;
            const wipInv = parseFloat(document.getElementById('wip_inventory').value) || 0;
            const fgInv = parseFloat(document.getElementById('fg_inventory').value) || 0;
            const capitalRate = parseFloat(document.getElementById('capital_rate').value) || 0;
            const turnoverDays = parseFloat(document.getElementById('turnover_days').value) || 0;
            
            const totalInv = rawInv + wipInv + fgInv;
            const invCapitalCost = totalInv * (capitalRate / 100) * turnoverDays / 365;
            costData.capital.inventory = invCapitalCost;
            document.getElementById('total_inventory').textContent = 'Â¥' + formatMoney(totalInv);
            document.getElementById('inv_capital_cost').textContent = 'Â¥' + formatMoney(invCapitalCost);
            document.getElementById('inv_summary').textContent = 'Â¥' + formatMoney(invCapitalCost);
            
            const arBalance = parseFloat(document.getElementById('receivable_balance').value) || 0;
            const creditDays = parseFloat(document.getElementById('avg_credit_days').value) || 0;
            const arRate = parseFloat(document.getElementById('ar_capital_rate').value) || 0;
            const arCapitalCost = arBalance * (arRate / 100) * creditDays / 365;
            costData.capital.receivable = arCapitalCost;
            document.getElementById('ar_capital_cost').textContent = 'Â¥' + formatMoney(arCapitalCost);
            document.getElementById('ar_summary').textContent = 'Â¥' + formatMoney(arCapitalCost);
            
            const capitalTotal = invCapitalCost + arCapitalCost;
            document.getElementById('capital_total').textContent = 'Â¥' + formatMoney(capitalTotal);
            document.getElementById('kpi_turnover').textContent = turnoverDays + 'å¤©';
            updateSummary();
        }

        // æ›´æ–°é£é™©æˆæœ¬
        function updateRiskCost() {
            const returnQty = parseFloat(document.getElementById('return_qty').value) || 0;
            const returnUnitCost = parseFloat(document.getElementById('return_unit_cost').value) || 0;
            const claimAmount = parseFloat(document.getElementById('claim_amount').value) || 0;
            const brandImpact = parseFloat(document.getElementById('brand_impact').value) || 0;
            const qualityCost = returnQty * returnUnitCost + claimAmount + brandImpact;
            costData.risk.quality = qualityCost;
            document.getElementById('quality_risk_cost').textContent = 'Â¥' + formatMoney(qualityCost);
            document.getElementById('quality_summary').textContent = 'Â¥' + formatMoney(qualityCost);
            
            const stockoutTimes = parseFloat(document.getElementById('stockout_times').value) || 0;
            const stockoutLoss = parseFloat(document.getElementById('stockout_loss').value) || 0;
            const urgentPremium = parseFloat(document.getElementById('urgent_premium').value) || 0;
            const supplyCost = stockoutTimes * stockoutLoss + urgentPremium;
            costData.risk.supply = supplyCost;
            document.getElementById('supply_risk_cost').textContent = 'Â¥' + formatMoney(supplyCost);
            document.getElementById('supply_summary').textContent = 'Â¥' + formatMoney(supplyCost);
            
            const monthlyPurchase = parseFloat(document.getElementById('monthly_purchase').value) || 0;
            const volatility = parseFloat(document.getElementById('price_volatility').value) || 0;
            const exposure = parseFloat(document.getElementById('risk_exposure').value) || 0;
            const priceCost = monthlyPurchase * (volatility / 100) * (exposure / 100);
            costData.risk.price = priceCost;
            document.getElementById('price_risk_cost').textContent = 'Â¥' + formatMoney(priceCost);
            document.getElementById('price_summary').textContent = 'Â¥' + formatMoney(priceCost);
            
            const riskTotal = qualityCost + supplyCost + priceCost;
            document.getElementById('risk_total').textContent = 'Â¥' + formatMoney(riskTotal);
            updateSummary();
        }

        // å›¾è¡¨å®ä¾‹
        let pieChart = null;

        // æ›´æ–°æ±‡æ€»é¢æ¿
        function updateSummary() {
            const material = costData.direct.material;
            const labor = costData.direct.labor;
            const overhead = costData.direct.overhead;
            const activity = Object.values(costData.activity).reduce((a, b) => a + b, 0);
            const capital = costData.capital.inventory + costData.capital.receivable;
            const risk = Object.values(costData.risk).reduce((a, b) => a + b, 0);
            const total = material + labor + overhead + activity + capital + risk;
            const qty = parseFloat(document.getElementById('production_qty').value) || 1;
            
            document.getElementById('grand_total').textContent = 'Â¥' + formatMoney(total);
            document.getElementById('unit_cost').textContent = 'Â¥' + formatMoney(total / qty);
            document.getElementById('kpi_unit_cost').textContent = 'Â¥' + formatMoney(total / qty);
            
            const hiddenPct = ((activity + capital + risk) / total * 100).toFixed(1);
            document.getElementById('kpi_hidden_pct').textContent = hiddenPct + '%';
            
            // æ›´æ–°è¡¨æ ¼
            document.getElementById('tb_material').textContent = formatMoney(material);
            document.getElementById('tb_labor').textContent = formatMoney(labor);
            document.getElementById('tb_overhead').textContent = formatMoney(overhead);
            document.getElementById('tb_activity').textContent = formatMoney(activity);
            document.getElementById('tb_capital').textContent = formatMoney(capital);
            document.getElementById('tb_risk').textContent = formatMoney(risk);
            document.getElementById('tb_total').textContent = formatMoney(total);
            
            document.getElementById('tb_material_pct').textContent = (material/total*100).toFixed(1) + '%';
            document.getElementById('tb_labor_pct').textContent = (labor/total*100).toFixed(1) + '%';
            document.getElementById('tb_overhead_pct').textContent = (overhead/total*100).toFixed(1) + '%';
            document.getElementById('tb_activity_pct').textContent = (activity/total*100).toFixed(1) + '%';
            document.getElementById('tb_capital_pct').textContent = (capital/total*100).toFixed(1) + '%';
            document.getElementById('tb_risk_pct').textContent = (risk/total*100).toFixed(1) + '%';
            
            updateChart(material, labor, overhead, activity, capital, risk);
        }

        // æ›´æ–°é¥¼å›¾
        function updateChart(material, labor, overhead, activity, capital, risk) {
            const ctx = document.getElementById('costPieChart').getContext('2d');
            if (pieChart) pieChart.destroy();
            pieChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['ç›´æ¥ææ–™', 'ç›´æ¥äººå·¥', 'åˆ¶é€ è´¹ç”¨', 'ä½œä¸šæˆæœ¬', 'èµ„é‡‘æˆæœ¬', 'é£é™©æˆæœ¬'],
                    datasets: [{
                        data: [material, labor, overhead, activity, capital, risk],
                        backgroundColor: ['#e94560', '#533483', '#0f3460', '#4ade80', '#f97316', '#fbbf24'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'right', labels: { color: '#fff', font: { size: 12 } } }
                    }
                }
            });
        }

        // é‡æ–°è®¡ç®—æ‰€æœ‰
        function recalculateAll() {
            updateDirectCost();
            updateActivityCost();
            updateCapitalCost();
            updateRiskCost();
            alert('æ‰€æœ‰æˆæœ¬å·²é‡æ–°è®¡ç®—ï¼');
        }

        // å¯¼å‡ºæŠ¥è¡¨
        function exportReport() {
            const total = calculateTotalCost();
            const qty = parseFloat(document.getElementById('production_qty').value) || 1;
            const report = `è½´æ‰¿ä¾›åº”é“¾æ€»æˆæœ¬ç®¡æ§æŠ¥è¡¨\nç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString()}\n` +
                `============================\n` +
                `ç›´æ¥ææ–™æˆæœ¬: Â¥${formatMoney(costData.direct.material)}\n` +
                `ç›´æ¥äººå·¥æˆæœ¬: Â¥${formatMoney(costData.direct.labor)}\n` +
                `ç›´æ¥åˆ¶é€ è´¹ç”¨: Â¥${formatMoney(costData.direct.overhead)}\n` +
                `ä½œä¸šæˆæœ¬åˆè®¡: Â¥${formatMoney(Object.values(costData.activity).reduce((a,b)=>a+b,0))}\n` +
                `èµ„é‡‘æˆæœ¬åˆè®¡: Â¥${formatMoney(costData.capital.inventory + costData.capital.receivable)}\n` +
                `é£é™©æˆæœ¬åˆè®¡: Â¥${formatMoney(Object.values(costData.risk).reduce((a,b)=>a+b,0))}\n` +
                `============================\n` +
                `ä¾›åº”é“¾æ€»æˆæœ¬: Â¥${formatMoney(total)}\n` +
                `å•ä»¶æˆæœ¬: Â¥${formatMoney(total/qty)}\n`;
            const blob = new Blob([report], { type: 'text/plain;charset=utf-8' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'ä¾›åº”é“¾æ€»æˆæœ¬æŠ¥è¡¨.txt';
            a.click();
        }

        // é¡µé¢åŠ è½½åˆå§‹åŒ–
        window.onload = function() {
            updateDirectCost();
            updateActivityCost();
            updateCapitalCost();
            updateRiskCost();
        };
    </script>
</body>
</html>
